name: CI

on:
  pull_request:
    branches: ["main"]

#jobs:
#  call-template:
#    uses: maksim-sialitski-innowise/devops-automation/integration/templates/function-template.yml@main
#    with:
#      name: "Run build via template"

jobs:
  verify-pr:
    runs-on: ubuntu-latest
    
    steps:
      # 1. Checkout code
      - uses: actions/checkout@v4
      
      # 2. Check package-lock.json exists (locked dependencies requirement)
      - name: Check locked dependencies
        run: test -f package-lock.json || (echo "package-lock.json missing" && exit 1)
      
      # 3. Setup Node.js
      - uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'npm'
      
      # 4. Install dependencies (using lock file)
      - name: Install dependencies
        run: npm ci
      
      # 5. Build TypeScript
      - name: Build
        run: npx tsc --noEmit || echo "Build check"